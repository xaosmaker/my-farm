// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: fields.sql

package db

import (
	"context"
	"encoding/json"
)

const createField = `-- name: CreateField :one
INSERT INTO fields (
  name,
  epsg_2100_boundary, 
  epsg_4326_boundary, 
  map_location, 
  field_location, 
  area_in_meters, 
  is_owned,
  farm_id,
  created_at,
  updated_at
)VALUES(
  $1,
  $2,
  $3,
  $4,
  $8,
  $5,
  $6,
  $7,
  CURRENT_TIMESTAMP,
  CURRENT_TIMESTAMP
  )RETURNING id, name, epsg_2100_boundary, epsg_4326_boundary, map_location, field_location, area_in_meters, is_owned, farm_id, created_at, updated_at, deleted_at
`

type CreateFieldParams struct {
	Name             string
	Epsg2100Boundary *json.RawMessage
	Epsg4326Boundary *json.RawMessage
	MapLocation      *json.RawMessage
	AreaInMeters     float64
	IsOwned          bool
	FarmID           int64
	FieldLocation    *string
}

func (q *Queries) CreateField(ctx context.Context, arg CreateFieldParams) (Field, error) {
	row := q.db.QueryRow(ctx, createField,
		arg.Name,
		arg.Epsg2100Boundary,
		arg.Epsg4326Boundary,
		arg.MapLocation,
		arg.AreaInMeters,
		arg.IsOwned,
		arg.FarmID,
		arg.FieldLocation,
	)
	var i Field
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Epsg2100Boundary,
		&i.Epsg4326Boundary,
		&i.MapLocation,
		&i.FieldLocation,
		&i.AreaInMeters,
		&i.IsOwned,
		&i.FarmID,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeletedAt,
	)
	return i, err
}

const deleteField = `-- name: DeleteField :exec
DELETE FROM fields
WHERE id = $1
`

func (q *Queries) DeleteField(ctx context.Context, id int64) error {
	_, err := q.db.Exec(ctx, deleteField, id)
	return err
}

const getAllFields = `-- name: GetAllFields :many
select id, name, epsg_2100_boundary, epsg_4326_boundary, map_location, field_location, area_in_meters, is_owned, farm_id, created_at, updated_at, deleted_at FROM fields
WHERE deleted_at IS NULL AND fields.farm_id = (
  SELECT id FROM farms
  WHERE deleted_at IS NULL AND farms.id = (
    SELECT farm_id FROM users
    WHERE deleted_at IS NULL AND users.id = $1
  )
)
ORDER BY id ASC
`

func (q *Queries) GetAllFields(ctx context.Context, userID int64) ([]Field, error) {
	rows, err := q.db.Query(ctx, getAllFields, userID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Field
	for rows.Next() {
		var i Field
		if err := rows.Scan(
			&i.ID,
			&i.Name,
			&i.Epsg2100Boundary,
			&i.Epsg4326Boundary,
			&i.MapLocation,
			&i.FieldLocation,
			&i.AreaInMeters,
			&i.IsOwned,
			&i.FarmID,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.DeletedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getFieldByIdAndUser = `-- name: GetFieldByIdAndUser :one
select id, name, epsg_2100_boundary, epsg_4326_boundary, map_location, field_location, area_in_meters, is_owned, farm_id, created_at, updated_at, deleted_at FROM fields
WHERE deleted_at IS NULL AND fields.id = $1 AND fields.farm_id = (
  SELECT id FROM farms
  WHERE deleted_at IS NULL AND farms.id = (
    SELECT farm_id FROM users
    WHERE deleted_at IS NULL AND users.id = $2
  )
)
`

type GetFieldByIdAndUserParams struct {
	FieldID int64
	UserID  int64
}

func (q *Queries) GetFieldByIdAndUser(ctx context.Context, arg GetFieldByIdAndUserParams) (Field, error) {
	row := q.db.QueryRow(ctx, getFieldByIdAndUser, arg.FieldID, arg.UserID)
	var i Field
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Epsg2100Boundary,
		&i.Epsg4326Boundary,
		&i.MapLocation,
		&i.FieldLocation,
		&i.AreaInMeters,
		&i.IsOwned,
		&i.FarmID,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeletedAt,
	)
	return i, err
}

const updateField = `-- name: UpdateField :one
UPDATE  fields SET
  updated_at = CURRENT_TIMESTAMP,
  name = COALESCE($2,name),
  epsg_2100_boundary =
    COALESCE($3,epsg_2100_boundary),
  epsg_4326_boundary =
    COALESCE($4,epsg_4326_boundary),
  area_in_meters =COALESCE($5,area_in_meters),
  map_location = COALESCE($6,map_location),
  field_location = COALESCE($7,field_location),
  is_owned = COALESCE($8,is_owned)
WHERE id = $1
  RETURNING id, name, epsg_2100_boundary, epsg_4326_boundary, map_location, field_location, area_in_meters, is_owned, farm_id, created_at, updated_at, deleted_at
`

type UpdateFieldParams struct {
	ID               int64
	Name             *string
	Epsg2100Boundary *json.RawMessage
	Epsg4326Boundary *json.RawMessage
	AreaInMeters     *float64
	MapLocation      *json.RawMessage
	FieldLocation    *string
	IsOwned          *bool
}

func (q *Queries) UpdateField(ctx context.Context, arg UpdateFieldParams) (Field, error) {
	row := q.db.QueryRow(ctx, updateField,
		arg.ID,
		arg.Name,
		arg.Epsg2100Boundary,
		arg.Epsg4326Boundary,
		arg.AreaInMeters,
		arg.MapLocation,
		arg.FieldLocation,
		arg.IsOwned,
	)
	var i Field
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Epsg2100Boundary,
		&i.Epsg4326Boundary,
		&i.MapLocation,
		&i.FieldLocation,
		&i.AreaInMeters,
		&i.IsOwned,
		&i.FarmID,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.DeletedAt,
	)
	return i, err
}
