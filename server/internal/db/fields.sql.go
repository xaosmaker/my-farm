// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: fields.sql

package db

import (
	"context"
	"encoding/json"
)

const createField = `-- name: CreateField :one
INSERT INTO "farm_field"(
  created_at,
  edited_at, 
  field_name,
  field_epsg_2100_boundary, 
  field_epsg_4326_boundary, 
  field_area_in_meters, 
  field_location, 
  farm_field_id,
  is_owned 
)VALUES(
  CURRENT_TIMESTAMP,
  CURRENT_TIMESTAMP,
  $1,
  $2,
  $3,
  $4,
  $5,
  $6,
  $7
  )RETURNING id, created_at, edited_at, field_name, field_epsg_2100_boundary, field_epsg_4326_boundary, field_area_in_meters, field_location, farm_field_id, is_owned
`

type CreateFieldParams struct {
	FieldName             string
	FieldEpsg2100Boundary *json.RawMessage
	FieldEpsg4326Boundary *json.RawMessage
	FieldAreaInMeters     float64
	FieldLocation         *json.RawMessage
	FarmFieldID           int64
	IsOwned               bool
}

func (q *Queries) CreateField(ctx context.Context, arg CreateFieldParams) (FarmField, error) {
	row := q.db.QueryRow(ctx, createField,
		arg.FieldName,
		arg.FieldEpsg2100Boundary,
		arg.FieldEpsg4326Boundary,
		arg.FieldAreaInMeters,
		arg.FieldLocation,
		arg.FarmFieldID,
		arg.IsOwned,
	)
	var i FarmField
	err := row.Scan(
		&i.ID,
		&i.CreatedAt,
		&i.EditedAt,
		&i.FieldName,
		&i.FieldEpsg2100Boundary,
		&i.FieldEpsg4326Boundary,
		&i.FieldAreaInMeters,
		&i.FieldLocation,
		&i.FarmFieldID,
		&i.IsOwned,
	)
	return i, err
}

const deleteField = `-- name: DeleteField :exec
DELETE FROM "farm_field"
WHERE id = $1
`

func (q *Queries) DeleteField(ctx context.Context, id int64) error {
	_, err := q.db.Exec(ctx, deleteField, id)
	return err
}

const getAllFields = `-- name: GetAllFields :many
select id, created_at, edited_at, field_name, field_epsg_2100_boundary, field_epsg_4326_boundary, field_area_in_meters, field_location, farm_field_id, is_owned FROM "farm_field"
WHERE "farm_field".farm_field_id = (
  SELECT id FROM "farm"
  WHERE "farm".id = (
    SELECT farm_id FROM "user"
    WHERE "user".id = $1
  )
)
`

func (q *Queries) GetAllFields(ctx context.Context, userID int64) ([]FarmField, error) {
	rows, err := q.db.Query(ctx, getAllFields, userID)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []FarmField
	for rows.Next() {
		var i FarmField
		if err := rows.Scan(
			&i.ID,
			&i.CreatedAt,
			&i.EditedAt,
			&i.FieldName,
			&i.FieldEpsg2100Boundary,
			&i.FieldEpsg4326Boundary,
			&i.FieldAreaInMeters,
			&i.FieldLocation,
			&i.FarmFieldID,
			&i.IsOwned,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const getFieldByIdAndUser = `-- name: GetFieldByIdAndUser :one
select id, created_at, edited_at, field_name, field_epsg_2100_boundary, field_epsg_4326_boundary, field_area_in_meters, field_location, farm_field_id, is_owned FROM "farm_field"
WHERE "farm_field".id = $1 AND "farm_field".farm_field_id = (
  SELECT id FROM "farm"
  WHERE "farm".id = (
    SELECT farm_id FROM "user"
    WHERE "user".id = $2
  )
)
`

type GetFieldByIdAndUserParams struct {
	FarmFieldID int64
	UserID      int64
}

func (q *Queries) GetFieldByIdAndUser(ctx context.Context, arg GetFieldByIdAndUserParams) (FarmField, error) {
	row := q.db.QueryRow(ctx, getFieldByIdAndUser, arg.FarmFieldID, arg.UserID)
	var i FarmField
	err := row.Scan(
		&i.ID,
		&i.CreatedAt,
		&i.EditedAt,
		&i.FieldName,
		&i.FieldEpsg2100Boundary,
		&i.FieldEpsg4326Boundary,
		&i.FieldAreaInMeters,
		&i.FieldLocation,
		&i.FarmFieldID,
		&i.IsOwned,
	)
	return i, err
}

const updateField = `-- name: UpdateField :one
UPDATE  "farm_field" SET
  edited_at = CURRENT_TIMESTAMP,
  field_name = COALESCE($2,field_name),
  field_epsg_2100_boundary =
          COALESCE($3,field_epsg_2100_boundary),
  field_epsg_4326_boundary =
          COALESCE($4,field_epsg_4326_boundary),
  field_area_in_meters =COALESCE($5,field_area_in_meters),
  field_location = COALESCE($6,field_location),
  -- farm_field_id = COALESCE(sqlc.narg('farm_field_id'),farm_field_id),
  is_owned = COALESCE($7,is_owned)
WHERE id = $1
  RETURNING id, created_at, edited_at, field_name, field_epsg_2100_boundary, field_epsg_4326_boundary, field_area_in_meters, field_location, farm_field_id, is_owned
`

type UpdateFieldParams struct {
	ID                    int64
	FieldName             *string
	FieldEpsg2100Boundary *json.RawMessage
	FieldEpsg4326Boundary *json.RawMessage
	FieldAreaInMeters     *float64
	FieldLocation         *json.RawMessage
	IsOwned               *bool
}

func (q *Queries) UpdateField(ctx context.Context, arg UpdateFieldParams) (FarmField, error) {
	row := q.db.QueryRow(ctx, updateField,
		arg.ID,
		arg.FieldName,
		arg.FieldEpsg2100Boundary,
		arg.FieldEpsg4326Boundary,
		arg.FieldAreaInMeters,
		arg.FieldLocation,
		arg.IsOwned,
	)
	var i FarmField
	err := row.Scan(
		&i.ID,
		&i.CreatedAt,
		&i.EditedAt,
		&i.FieldName,
		&i.FieldEpsg2100Boundary,
		&i.FieldEpsg4326Boundary,
		&i.FieldAreaInMeters,
		&i.FieldLocation,
		&i.FarmFieldID,
		&i.IsOwned,
	)
	return i, err
}
